<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>1 R Basics | Algorithms and Financial programing in R</title>
<meta name="author" content="Arturo Bernal">
<meta name="description" content="1.1 1 R Markdown In this book we will work on R Markdowns, which is a document format to embed code chunks (of R or other languages) in documents. But most important, it allows to print (knitr) in...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="1 R Basics | Algorithms and Financial programing in R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://www.arturo-bernal.com/book/r-basics.html">
<meta property="og:image" content="https://www.arturo-bernal.com/book/images/coverf.png">
<meta property="og:description" content="1.1 1 R Markdown In this book we will work on R Markdowns, which is a document format to embed code chunks (of R or other languages) in documents. But most important, it allows to print (knitr) in...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="1 R Basics | Algorithms and Financial programing in R">
<meta name="twitter:description" content="1.1 1 R Markdown In this book we will work on R Markdowns, which is a document format to embed code chunks (of R or other languages) in documents. But most important, it allows to print (knitr) in...">
<meta name="twitter:image" content="https://www.arturo-bernal.com/book/images/coverf.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Roboto-0.4.1/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-68765210-2', 'auto');
      ga('send', 'pageview');

    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Algorithms and Financial programing in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Algorithms and Financial programing in R</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="active" href="r-basics.html"><span class="header-section-number">1</span> R Basics</a></li>
<li><a class="" href="clean.html"><span class="header-section-number">2</span> Big data and data cleaning</a></li>
<li><a class="" href="graphs.html"><span class="header-section-number">3</span> APIS and R graphs</a></li>
<li><a class="" href="logit.html"><span class="header-section-number">4</span> Machine learning with market direction prediction: Logit</a></li>
<li><a class="" href="big-data-and-machine-learning.html"><span class="header-section-number">5</span> Big data and machine learning</a></li>
<li><a class="" href="credit-analysis.html"><span class="header-section-number">6</span> Credit analysis</a></li>
<li><a class="" href="rational-agent-and-behavioral-finance-in-investment.html"><span class="header-section-number">7</span> Rational agent and behavioral finance in investment</a></li>
<li><a class="" href="momentum-or-directional-trading.html"><span class="header-section-number">8</span> Momentum or directional trading</a></li>
<li><a class="" href="portfolio-management-algorithms.html"><span class="header-section-number">9</span> Portfolio management algorithms</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/datanalyticss/bookAFMR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="r-basics" class="section level1" number="1">
<h1>
<span class="header-section-number">1</span> R Basics<a class="anchor" aria-label="anchor" href="#r-basics"><i class="fas fa-link"></i></a>
</h1>
<div id="r-markdown" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> 1 R Markdown<a class="anchor" aria-label="anchor" href="#r-markdown"><i class="fas fa-link"></i></a>
</h2>
<p>In this book we will work on R Markdowns, which is a document format to embed code chunks (of R or other languages) in documents. But most important, it allows to print (knitr) in other authoring languages including LaTeX, HTML, Text, among others.</p>
<p>For See more markdown content at: <span class="citation">(<a href="portfolio-management-algorithms.html#ref-R-Markdown" role="doc-biblioref">Yihui Xie and Grolemund 2019</a>)</span>.</p>
</div>
<div id="coding-basics" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> 2 Coding basics<a class="anchor" aria-label="anchor" href="#coding-basics"><i class="fas fa-link"></i></a>
</h2>
<p>The entities that we can create and manipulate in R are called objects. These may be variables, arrays of numbers, character strings, functions, or more general structures. Those objects are created applying the assignment operator (‘&lt;-’). It consists of the two characters ‘&lt;’ (“less than”) and ‘-’ (“minus”) occurring strictly side-by-side and it ‘points’ to the object receiving the value of the expression <span class="citation">(<a href="portfolio-management-algorithms.html#ref-introduction-R" role="doc-biblioref">Team 2022</a>)</span>.</p>
<p>We also could apply the operator ‘=’, however, in my experience, some functions use the “=” operator inside, and could be confused.</p>
<p>For example, we create the object “a”, wich has assigned the value 4.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">&lt;-</span> <span class="fl">4</span> </span></code></pre></div>
<p>To delete an object from the environment. We can also use the function rm(). However, I suggest using R-studio. For an introduction to RStudio i suggest reviewing chapter 1 of the book <span class="citation">(<a href="portfolio-management-algorithms.html#ref-rstudio" role="doc-biblioref">Ismay and Kim 2019</a>)</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="objet-types-atomic-structures" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Objet types: “atomic” structures<a class="anchor" aria-label="anchor" href="#objet-types-atomic-structures"><i class="fas fa-link"></i></a>
</h2>
<p>Types of objects frequently used in finance applications are numeric, character, vectors and logical. These are known as “atomic” structures since their components are all of the same type. The rest of the objects, like matrix and Data frames, are built on these atomic objects.</p>
<p>Character strings are entered using either matching double (“) or single (’) quotes. For example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ticker</span><span class="op">&lt;-</span><span class="st">"APPL"</span> </span></code></pre></div>
<p>to print the object we use the function print or just typing the object name.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ticker</span></span>
<span><span class="co">#&gt; [1] "APPL"</span></span>
<span><span class="co"># or </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ticker</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "APPL"</span></span></code></pre></div>
<p>To review the object class we use function “class”:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ticker</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "character"</span></span></code></pre></div>
<p>Numeric objects.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num</span><span class="op">&lt;-</span><span class="fl">4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "numeric"</span></span></code></pre></div>
<p>A vector consist of an ordered collection of numbers or characters. To build a vector we apply the function concatenate “c()”. For example,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">160</span>,<span class="fl">165</span>,<span class="fl">167</span>,<span class="fl">145</span>,<span class="fl">145</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 160 165 167 145 145</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">v1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "numeric"</span></span></code></pre></div>
<p>As we can see, the object class is numeric, because the vector is taking the class of the atomic objects, in this case numeric. An example of a character vector:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Apple"</span>,<span class="st">"Meta"</span>,<span class="st">"Amazon"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">v2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Apple"  "Meta"   "Amazon"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">v2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "character"</span></span></code></pre></div>
<p>Selecting an element of a vector. To select an element we use brackets: “[]”. For example, to select the first element of vector “v2”:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Apple"</span></span></code></pre></div>
<p>Also we could select a sub sample:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Apple" "Meta"</span></span></code></pre></div>
<p>In the former example we just select a sub sample, but the object “v2” hasn’t changed. If we want to change the object we need to create a new one. For example, if we want to delete an element, we use the minus sign “-”. For example the 2nd element of “v2”:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2</span><span class="op">&lt;-</span><span class="va">v2</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">v2</span></span>
<span><span class="co">#&gt; [1] "Apple"  "Amazon"</span></span></code></pre></div>
<p>In this case the object “v2” has changed. Also, we could change an element of the vector, for example, changing the element “Amazon” by “Meta”:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"Meta"</span></span>
<span><span class="va">v2</span></span>
<span><span class="co">#&gt; [1] "Apple" "Meta"</span></span></code></pre></div>
<p>If we would like to add a new element, for example “Amazon_new”, we need to apply again the “c” function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">v2</span>,<span class="st">"Amazon_new"</span><span class="op">)</span></span>
<span><span class="va">v2</span></span>
<span><span class="co">#&gt; [1] "Apple"      "Meta"       "Amazon_new"</span></span></code></pre></div>
</div>
<div id="data-frames" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Data frames<a class="anchor" aria-label="anchor" href="#data-frames"><i class="fas fa-link"></i></a>
</h2>
<p>In Finance is common and practical using Data Frames, which are tabular-form data objects where each column can be of different form, that is, numeric or character.</p>
<p>For this example we are going to use an already created data frame, from library Wooldridge. Get the data frame k401k from the library Wooldridge</p>
<p>Remember that a library is a set of functions that someone created. The Wooldridge library has many data sets from the econometrics book of the author <span class="citation">(<a href="portfolio-management-algorithms.html#ref-wooldridge" role="doc-biblioref">Wooldridge 2020</a>)</span>.</p>
<p>To import the library, apply the function library()</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://justinmshea.github.io/wooldridge/">wooldridge</a></span><span class="op">)</span> </span></code></pre></div>
<p>To import a databases from the library, the library must be imported, and just calling the data set name, in this case “k401k”.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k4</span><span class="op">&lt;-</span><span class="va">k401k</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">k4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "data.frame"</span></span></code></pre></div>
<p>As we can see the object class is Data Frame.</p>
<p>The function “colnames” shows the names of each column of the data frame. in this case, it is a character vector:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">k4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "prate"   "mrate"   "totpart" "totelg"  "age"     "totemp"  "sole"   </span></span>
<span><span class="co">#&gt; [8] "ltotemp"</span></span></code></pre></div>
<p>Some times is convenient to change the column or rows names of a data frame, for example, change the name of the first column, to ““prate_1”. In this case we use the function “colnames” and select, in brackets, the column number we want to change. Because we are changing the column names vector, we need to establish it with the assignment operator “&lt;-”.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">k4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"prate_1"</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">k4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "prate_1" "mrate"   "totpart" "totelg"  "age"     "totemp"  "sole"   </span></span>
<span><span class="co">#&gt; [8] "ltotemp"</span></span></code></pre></div>
<p>To show or change a row name, we use the “rownames” function. For convenience, we select the first 5 rows.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">k4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "1" "2" "3" "4" "5"</span></span></code></pre></div>
<p>We could apply the same procedure we made in the “colnames” function to modify a row of a data frame.</p>
<p>Selecting rows or columns</p>
<p>There are many ways to select a column or a row of a data frame.</p>
<p>Selecting rows or columns by position, for example selecting the first row, column 5. A data frame has two dimensions, rows and columns, for selecting we also use brackets, separating the rows and columns by a</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k4</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 8</span></span></code></pre></div>
<p>Selecting columns by $ symbol</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k4</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1]  8  6 10  7 28  7 31 13 21 10</span></span></code></pre></div>
<p>Merging two data frames by its columns.</p>
<p>Suppose you have the following Data Frame:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span><span class="op">&lt;-</span><span class="va">k4</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"prate_1"</span>,<span class="st">"totpart"</span>,<span class="st">"age"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df2</span><span class="op">&lt;-</span><span class="va">k4</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"totemp"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">df3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df1</span>,<span class="va">df2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df3</span>,<span class="fl">10</span><span class="op">)</span> </span>
<span><span class="co">#&gt;   prate_1 totpart age age totemp</span></span>
<span><span class="co">#&gt; 1    26.1    1653   8   8   8709</span></span>
<span><span class="co">#&gt; 2   100.0     262   6   6    315</span></span>
<span><span class="co">#&gt; 3    97.6     166  10  10    275</span></span>
<span><span class="co">#&gt; 4   100.0     257   7   7    500</span></span>
<span><span class="co">#&gt; 5    82.5     591  28  28    933</span></span>
<span><span class="co">#&gt; 6   100.0      92   7   7    143</span></span></code></pre></div>
<p>Print the the dimension of each data frame, applying the function paste, print and dim:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dim</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span> </span>
<span><span class="va">dim</span></span>
<span><span class="co">#&gt; [1] 6 5</span></span></code></pre></div>
<p>Applying the function cbind to merge the two data frames and call the object df3</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span><span class="op">&lt;-</span><span class="va">k4</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"prate_1"</span>,<span class="st">"totpart"</span>,<span class="st">"age"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df2</span><span class="op">&lt;-</span><span class="va">k4</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"totemp"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df1</span>,<span class="va">df2</span><span class="op">)</span></span>
<span><span class="va">df3</span></span>
<span><span class="co">#&gt;   prate_1 totpart age age totemp</span></span>
<span><span class="co">#&gt; 1    26.1    1653   8   8   8709</span></span>
<span><span class="co">#&gt; 2   100.0     262   6   6    315</span></span>
<span><span class="co">#&gt; 3    97.6     166  10  10    275</span></span>
<span><span class="co">#&gt; 4   100.0     257   7   7    500</span></span>
<span><span class="co">#&gt; 5    82.5     591  28  28    933</span></span>
<span><span class="co">#&gt; 6   100.0      92   7   7    143</span></span></code></pre></div>
<p>Note that the method is duplicating the column age.</p>
<p>To takeoff one of the columns, select by number position adding minus symbol</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df3</span><span class="op">&lt;-</span><span class="va">df3</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">df3</span></span>
<span><span class="co">#&gt;   prate_1 totpart age totemp</span></span>
<span><span class="co">#&gt; 1    26.1    1653   8   8709</span></span>
<span><span class="co">#&gt; 2   100.0     262   6    315</span></span>
<span><span class="co">#&gt; 3    97.6     166  10    275</span></span>
<span><span class="co">#&gt; 4   100.0     257   7    500</span></span>
<span><span class="co">#&gt; 5    82.5     591  28    933</span></span>
<span><span class="co">#&gt; 6   100.0      92   7    143</span></span></code></pre></div>
<p>Create a new variable, tot_part_age (totpart/age) and a variable that is the row names or index, call it index, of the data frame. Insert both into the object df3.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df3</span><span class="op">[</span><span class="st">" tot_part_age"</span><span class="op">]</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">df3</span><span class="op">[</span>,<span class="st">"totpart"</span><span class="op">]</span><span class="op">/</span><span class="va">df3</span><span class="op">[</span>,<span class="st">"age"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df3</span><span class="op">[</span><span class="st">"index"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span></span></code></pre></div>
<p>Eliminate the 2nd row of object df3 and call it df4.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df4</span><span class="op">&lt;-</span><span class="va">df3</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span>,<span class="op">]</span></span></code></pre></div>
<p>Apply again the function cbind to merge the df3 and df4</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#df5&lt;-cbind(df3,df4)</span></span></code></pre></div>
<p>It is goig to show a debug “Error in data.frame(…, check.names = FALSE) :
arguments imply differing number of rows: 6, 5”, which means that the number of rows is not the same.</p>
<p>Careful: if the number of rows of a data frames is a multiple of another, by coincidence the cbind function would do the merge. However, R is going to fill the missing values repeating the values of a data frame.</p>
<p>Try now with the function merge(x,y,by.x=,by.y=,all=T or F, all.x=T or F, all.y=T or F)</p>
<p>The merge function needs a pivot or a reference variable to make the merge. In this case the column index or identification id (both share the same variable). That id must be a unique value for each row and must be present in both data frames. Also, we need to specify if we want to keep all the data in data frame x or y.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df5</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">df3</span>,<span class="va">df4</span>,by.x<span class="op">=</span><span class="st">"age"</span>,by.y<span class="op">=</span><span class="st">"age"</span><span class="op">)</span></span>
<span><span class="va">df5</span></span>
<span><span class="co">#&gt;   age prate_1.x totpart.x totemp.x  tot_part_age.x index.x prate_1.y totpart.y</span></span>
<span><span class="co">#&gt; 1   7     100.0       257      500        36.71429       4     100.0       257</span></span>
<span><span class="co">#&gt; 2   7     100.0       257      500        36.71429       4     100.0        92</span></span>
<span><span class="co">#&gt; 3   7     100.0        92      143        13.14286       6     100.0       257</span></span>
<span><span class="co">#&gt; 4   7     100.0        92      143        13.14286       6     100.0        92</span></span>
<span><span class="co">#&gt; 5   8      26.1      1653     8709       206.62500       1      26.1      1653</span></span>
<span><span class="co">#&gt; 6  10      97.6       166      275        16.60000       3      97.6       166</span></span>
<span><span class="co">#&gt; 7  28      82.5       591      933        21.10714       5      82.5       591</span></span>
<span><span class="co">#&gt;   totemp.y  tot_part_age.y index.y</span></span>
<span><span class="co">#&gt; 1      500        36.71429       4</span></span>
<span><span class="co">#&gt; 2      143        13.14286       6</span></span>
<span><span class="co">#&gt; 3      500        36.71429       4</span></span>
<span><span class="co">#&gt; 4      143        13.14286       6</span></span>
<span><span class="co">#&gt; 5     8709       206.62500       1</span></span>
<span><span class="co">#&gt; 6      275        16.60000       3</span></span>
<span><span class="co">#&gt; 7      933        21.10714       5</span></span></code></pre></div>
</div>
<div id="xts-objects" class="section level2" number="1.5">
<h2>
<span class="header-section-number">1.5</span> xts objects<a class="anchor" aria-label="anchor" href="#xts-objects"><i class="fas fa-link"></i></a>
</h2>
<p>An xts class of object provide for uniform handling of R’s different time-based data classes. Also, some API´s, such as quantmod, download the data in xts format. For example, from the library xts I write into xlsx file the data set “sample_matrix”.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#data(sample_matrix)</span></span>
<span><span class="co">#sm&lt;-get("sample_matrix")</span></span>
<span><span class="co">#data_df&lt;-data.frame(sample_matrix)</span></span>
<span><span class="co">#date&lt;-rownames(data_df)</span></span>
<span><span class="co">#data_df&lt;-cbind(date,data_df)</span></span>
<span><span class="co">#write.xlsx(data_df,"data/data_df.xlsx")</span></span></code></pre></div>
<p>In the next section I covered how to read an “xlsx” file.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></span>
<span><span class="va">data_df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">"data/data_df.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>By default the object class is a data frame. A feature of the “xts” objects is that the rownames are dates objects. Then first I replace the numerical rownames by the dates inside the object.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">date</span><span class="op">&lt;-</span><span class="va">data_df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">data_df</span><span class="op">)</span><span class="op">&lt;-</span><span class="va">date</span></span>
<span><span class="co"># Also I eliminate the dates in row one. </span></span>
<span><span class="va">data_df_2</span><span class="op">&lt;-</span><span class="va">data_df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/xts">xts</a></span><span class="op">)</span></span>
<span><span class="va">data_xts</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xts/man/as.xts.html">as.xts</a></span><span class="op">(</span><span class="va">data_df_2</span><span class="op">)</span></span></code></pre></div>
<p>There are some useful functions that we can use with xts objects, for example transforming into weekly, monthly, quarterly, yearly ,etc.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_xt_m</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/xts/man/apply.monthly.html">apply.monthly</a></span><span class="op">(</span><span class="va">data_xts</span>,<span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<p>Making a sub sample:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub_set</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">data_xts</span>,</span>
<span>  <span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/index.html">index</a></span><span class="op">(</span><span class="va">data_xts</span><span class="op">)</span><span class="op">&gt;=</span><span class="st">"2007-05-01"</span> <span class="op">&amp;</span></span>
<span>  <span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/index.html">index</a></span><span class="op">(</span><span class="va">data_xts</span><span class="op">)</span><span class="op">&lt;=</span><span class="st">"2007-06-30"</span><span class="op">)</span></span></code></pre></div>
<p>Note that in this two examples, we could use the apply.monthly to an object like data_df_2 and it will work, because it has as rownames the dates, but we can´t apply the subset function to that object, it would generate an empty object.</p>
</div>
<div id="reading-and-writing-csv-and-xlsx" class="section level2" number="1.6">
<h2>
<span class="header-section-number">1.6</span> Reading and writing csv and xlsx<a class="anchor" aria-label="anchor" href="#reading-and-writing-csv-and-xlsx"><i class="fas fa-link"></i></a>
</h2>
<p>There are some libraries to write and open an xlsx or csv files. I suggest using “openxlsx”.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">df5</span>,<span class="st">"data/df5.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">df5</span>,<span class="st">"data/df5.csv"</span><span class="op">)</span></span></code></pre></div>
<p>To open a file use, the File must be in the same directory or we need to specify the directory location; otherwise, it would be an error:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></span>
<span><span class="va">fdf5_x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">"data/df5.xlsx"</span><span class="op">)</span></span>
<span><span class="va">fdf5_c</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/df5.csv"</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="preface.html">Preface</a></div>
<div class="next"><a href="clean.html"><span class="header-section-number">2</span> Big data and data cleaning</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-basics"><span class="header-section-number">1</span> R Basics</a></li>
<li><a class="nav-link" href="#r-markdown"><span class="header-section-number">1.1</span> 1 R Markdown</a></li>
<li><a class="nav-link" href="#coding-basics"><span class="header-section-number">1.2</span> 2 Coding basics</a></li>
<li><a class="nav-link" href="#objet-types-atomic-structures"><span class="header-section-number">1.3</span> Objet types: “atomic” structures</a></li>
<li><a class="nav-link" href="#data-frames"><span class="header-section-number">1.4</span> Data frames</a></li>
<li><a class="nav-link" href="#xts-objects"><span class="header-section-number">1.5</span> xts objects</a></li>
<li><a class="nav-link" href="#reading-and-writing-csv-and-xlsx"><span class="header-section-number">1.6</span> Reading and writing csv and xlsx</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/datanalyticss/bookAFMR/blob/master/01-R-Basics.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/datanalyticss/bookAFMR/edit/master/01-R-Basics.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Algorithms and Financial programing in R</strong>" was written by Arturo Bernal. It was last built on 2022-07-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
